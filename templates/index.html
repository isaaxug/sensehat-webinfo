<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Enviro pHat Control</title>
    <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
    <link rel="shortcut icon" type="image/png" href="https://isaax.io/assets/images/favicon.ico">
    <style type="text/css">
        body {
            background-color: #442f94;
            color: #fff;
            font-family: 'Ubuntu', sans-serif;
            font-weight: bold;
        }
        #mainimage {
            width:100%;
            padding: 2em 0 1em;
            text-align: center;
        }
        #mainimage svg {
            width: 6em;
        }
        #app {
            margin: auto auto;
            max-width: 50em;
            padding: 0 .5em;
        }
        #app .values {
            font-size: 2em;
        }
        #app .scale {
            font-size:0.8em;
        }
        .midashi {
            display: inline-block;
            width: 6em;
            font-size: 0.6em;
        }
        #ledsIcon {
            text-align: center;
        }
        #ledsIcon svg .st0{
            fill: #372d5f;
        }
        #ledsIcon._on svg .st0{
            fill: #e6e66d;
        }
        ul {list-style-type: none}
        .btn{
            font-size: 1.2em;
            cursor: pointer;
            display: inline-block;
            padding: 0.5em 1em;
            text-decoration: none;
            width: 100%;
            background: rgba(253, 253, 253, 0);
            color: #fff;
            border: solid 1px #fff;
            outline: none;
            margin-top: 1em;
        }
    </style>
</head>
<body>
<div id="mainimage">
    <svg version="1.1" id="layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
         y="0px" viewBox="0 0 300 300" style="enable-background:new 0 0 300 300;" xml:space="preserve">
        <style type="text/css">.st0{fill:#FFFFFF;}</style>
        <path class="st0" d="M123.5,133.5c0,7.9-6.4,14.3-14.3,14.3s-14.3-6.4-14.3-14.3s6.4-14.3,14.3-14.3S123.5,125.6,123.5,133.5z M197.2,119.2c-7.9,0-14.3,6.4-14.3,14.3s6.4,14.3,14.3,14.3c7.9,0,14.3-6.4,14.3-14.3S205.1,119.2,197.2,119.2z M57.4,83.4 c-0.3-0.3-0.8-0.5-1.2-0.5c-0.1,0-0.3,0-0.4,0.1c-23.1,6.4-39.3,27.6-39.3,51.6c0,10.9,3.3,21.4,9.4,30.4c0.3,0.4,0.8,0.7,1.4,0.7 c0.1,0,0.1,0,0.2,0c0.6-0.1,1.1-0.5,1.4-1.1l28.9-79.4C57.9,84.5,57.8,83.8,57.4,83.4z M167.5,133.5c0-16.4,13.3-29.7,29.7-29.7 c0.4,0,0.9,0,1.4,0h0.1c0.7,0,1.3-0.4,1.6-1.1l3.3-9.2c0-0.1,0.1-0.2,0.1-0.4c0.5-1.8,0.7-3.7,0.7-5.6c0-11.8-9.6-21.4-21.4-21.4 c-2.4,0-4.7,0.4-6.9,1.1l0,0c-0.1,0.1-0.3,0.1-0.5,0.1c-0.3,0-0.5-0.1-0.8-0.2c-0.4-0.2-0.6-0.6-0.6-1V66 c-1.4-12.8-7.8-24.7-17.8-33c-0.3-0.2-0.7-0.4-1.1-0.4c-0.1,0-0.3,0-0.4,0c-0.5,0.1-0.9,0.5-1.1,1L126.7,108c-0.2,0.7,0,1.5,0.6,1.9 c7.3,5.6,11.7,14.4,11.7,23.6c0,16.4-13.3,29.7-29.7,29.7c-0.4,0-0.9,0-1.3,0h-0.1c-0.7,0-1.3,0.4-1.6,1.1l-7.8,21.5 c-0.2,0.5-0.1,1.1,0.2,1.5c0.3,0.4,0.8,0.7,1.4,0.7h68c0.7,0,1.3-0.4,1.5-1.1l10.2-27.9c0.2-0.7,0-1.5-0.6-1.9 C171.8,151.5,167.5,142.7,167.5,133.5z M79.5,133.5c0-16.4,13.3-29.7,29.7-29.7c0.4,0,0.9,0,1.3,0h0.1c0.7,0,1.3-0.4,1.6-1.1 l28-76.9c0.1-0.4,0.1-0.9-0.1-1.3c-0.2-0.4-0.6-0.7-1-0.9c-4.7-1.4-9.6-2.2-14.5-2.2c-27.6,0-50,22.4-50,49.9c0,3,0.3,6.1,0.8,9.1 c0.1,0.6,0,1.2,0,1.2l-34.9,95.9c-0.3,0.7,0,1.6,0.7,2c8.6,5.5,18.6,8.4,28.8,8.4h10c0.7,0,1.3-0.4,1.6-1.1L91.7,159 c0.3-0.7,0-1.5-0.6-1.9C83.8,151.5,79.5,142.7,79.5,133.5z M279,106.2c-0.3-0.4-0.8-0.6-1.3-0.6c-0.1,0-0.2,0-0.3,0 c-0.6,0.1-1.1,0.5-1.3,1.1l-28.5,78.2c-0.2,0.6-0.1,1.2,0.3,1.7c0.3,0.4,0.8,0.6,1.3,0.6c0.1,0,0.2,0,0.3,0 c23.4-4.7,40.4-25.5,40.4-49.4C289.9,126.2,286,115,279,106.2z M263.1,93c-7.2-3.8-15.4-5.8-23.5-5.8c-6.1,0-12.1,1.1-17.8,3.2 c-0.5,0.2-0.8,0.5-1,1l-6,16.6c-0.2,0.7,0,1.5,0.6,1.9c7.3,5.6,11.7,14.4,11.7,23.6c0,16.4-13.3,29.7-29.7,29.7c-0.4,0-0.8,0-1.3,0 c0,0,0,0-0.1,0c-0.7,0-1.3,0.4-1.6,1.1l-7.8,21.5c-0.2,0.5-0.1,1.1,0.2,1.5s0.8,0.7,1.4,0.7h40.9c0.7,0,1.3-0.4,1.6-1.1L263.9,95 C264.1,94.2,263.8,93.4,263.1,93z"/>
        <g><path class="st0" d="M33.4,213.5c0,0.8-0.6,1.4-1.4,1.4h-9c-0.8,0-1.4-0.6-1.4-1.4v-8.9c0-0.8,0.6-1.4,1.4-1.4h9 c0.8,0,1.4,0.6,1.4,1.4V213.5z M33.4,228c0-0.8-0.6-1.4-1.4-1.4h-9c-0.8,0-1.4,0.6-1.4,1.4v53.6c0,0.8,0.6,1.4,1.4,1.4h9 c0.8,0,1.4-0.6,1.4-1.4V228z"/> <path class="st0" d="M61,240.4c2.4-1.1,5.8-2,10-2h24.4c0.8,0,1.4-0.6,1.4-1.4v-9c0-0.8-0.6-1.4-1.4-1.4H71 c-14.7,0-25.8,7.6-25.8,17.6v2.7c0,0.6,0.3,1,0.9,1.3l35,18.5c0.4,0.2,0.7,0.7,0.7,1.2s-0.3,1-0.8,1.2c-2.4,1.1-5.8,2-10,2H46.5 c-0.8,0-1.4,0.6-1.4,1.4v8.9c0,0.8,0.6,1.4,1.4,1.4H71c14.8,0,25.9-7.6,25.9-17.6v-2.7c0-0.6-0.4-1-0.9-1.3l-35-18.5 c-0.4-0.2-0.7-0.7-0.7-1.2C60.2,241.1,60.5,240.6,61,240.4z"/> <path class="st0" d="M134.4,226.6H110c-0.8,0-1.4,0.6-1.4,1.4v8.9c0,0.8,0.6,1.4,1.4,1.4h24.4c8.7,0,14.1,3.8,14.1,5.9v21.1 c0,2.1-5.4,5.9-14.1,5.9h-12.7c-0.8,0-1.4-0.6-1.4-1.4v-3.3c0-2.1,5.3-5.9,14.1-5.9h8c0.8,0,1.4-0.6,1.4-1.4v-8.9 c0-0.8-0.6-1.4-1.4-1.4h-8c-14.7,0-25.8,7.6-25.8,17.6v15c0,0.8,0.6,1.4,1.4,1.4h24.4c14.7,0,25.8-7.6,25.8-17.6v-21.1 C160.2,234.2,149.1,226.6,134.4,226.6z"/> <path class="st0" d="M196.9,226.6h-24.4c-0.8,0-1.4,0.6-1.4,1.4v8.9c0,0.8,0.6,1.4,1.4,1.4h24.4c8.8,0,14.1,3.8,14.1,5.9v21.1 c0,2.1-5.3,5.9-14.1,5.9h-12.7c-0.8,0-1.4-0.6-1.4-1.4v-3.3c0-2.1,5.4-5.9,14.1-5.9h8c0.8,0,1.4-0.6,1.4-1.4v-8.9 c0-0.8-0.6-1.4-1.4-1.4h-8c-14.7,0-25.8,7.6-25.8,17.6v15c0,0.8,0.6,1.4,1.4,1.4h24.4c14.7,0,25.8-7.6,25.8-17.6v-21.1 C222.7,234.2,211.6,226.6,196.9,226.6z"/> <path class="st0" d="M284.7,281.6c0,0.8-0.6,1.4-1.4,1.4h-9c-0.7,0-1.3-0.6-1.4-1.3l0,0c-0.3-6.3-2.6-10.7-4.5-12.2l-4.3-3.3 c-0.3-0.3-0.5-0.7-0.5-1.1s0.2-0.8,0.5-1.1l7.5-5.7c0.2-0.1,0.5-0.2,0.8-0.2s0.6,0.1,0.9,0.3l2.2,1.7 C280.9,264.2,284.4,272.1,284.7,281.6L284.7,281.6z M233,228c0.3,9.5,3.9,17.4,9.2,21.4l2.2,1.7c0.3,0.2,0.6,0.3,0.9,0.3 c0.3,0,0.5-0.1,0.8-0.2l7.5-5.7c0.3-0.3,0.5-0.7,0.5-1.1c0-0.4-0.2-0.8-0.5-1.1l-4.3-3.2c-1.9-1.5-4.2-5.9-4.5-12.2l0,0 c0-0.7-0.6-1.3-1.4-1.3h-9C233.7,226.6,233,227.3,233,228L233,228z M283.3,226.6h-8.9c-0.8,0-1.4,0.6-1.4,1.4l0,0 c-0.3,6.1-2.4,10.3-4.3,11.9l-26.5,20.2c-5.3,4.1-8.8,11.9-9.1,21.4l0,0c0,0.8,0.6,1.4,1.4,1.4h8.9c0.8,0,1.4-0.6,1.4-1.4l0,0 c0.3-6.3,2.6-10.6,4.5-12.1l26.3-20c5.3-4.1,8.8-11.9,9.1-21.4l0,0C284.7,227.2,284.1,226.6,283.3,226.6z"/>
        </g>
    </svg>
    <h1>Sense HAT</h1>
</div>
<div id="app">
    <div id="ledsIcon" v-bind:class="{ _on: state.leds }">
        <svg version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="width: 48px; height: 48px; opacity: 1;" xml:space="preserve">
        <g><path class="st0" d="M428.215,172.215c0.008-47.522-19.292-90.648-50.445-121.777C346.649,19.293,303.515-0.007,256,0 c-47.514-0.007-90.648,19.293-121.769,50.446c-31.153,31.121-50.454,74.247-50.446,121.769 c-0.008,31.786,8.673,61.634,23.754,87.181h-0.008c0.016,0.032,0.048,0.064,0.064,0.096c0.04,0.064,0.065,0.128,0.104,0.192 l0.016-0.007c10.98,19.436,26.7,34.724,38.945,48.835c6.167,7.056,11.452,13.751,15,20.014c3.572,6.295,5.382,11.908,5.502,17.53 v95.421c0.008,29.44,23.858,53.296,53.305,53.304h7.64C233.312,504.96,243.787,512,256,512c12.213,0,22.688-7.04,27.894-17.218 h7.64c29.447-0.008,53.296-23.865,53.304-53.304v-95.414v-0.008c0.12-5.622,1.93-11.236,5.502-17.53 c5.302-9.419,14.592-19.709,24.762-30.914c10.074-11.179,20.982-23.352,29.191-37.936l0.008,0.007 c0.032-0.048,0.056-0.111,0.088-0.16c0.024-0.048,0.056-0.08,0.08-0.128h-0.008C419.542,233.849,428.223,204.001,428.215,172.215z M311.828,461.771c-5.23,5.214-12.325,8.401-20.294,8.409h-71.068c-7.969-0.008-15.064-3.195-20.294-8.409 c-5.213-5.23-8.401-12.333-8.409-20.294v-5.326l120.128,25.54C311.868,461.715,311.852,461.747,311.828,461.771z M320.237,441.477 c0,1.754-0.216,3.452-0.513,5.11l-127.96-27.205v-33.524l128.473,27.316V441.477z M320.237,396.397L191.764,369.08V358.1h128.473 V396.397z M383.143,247.142l-0.104,0.169l-0.064,0.112c-8.505,15.408-22.92,29.848-36.159,44.904 c-6.607,7.576-12.918,15.361-17.867,24.034c-3.003,5.286-5.39,11.036-6.935,17.13H189.986c-1.546-6.102-3.932-11.844-6.944-17.13 c-7.432-12.982-17.867-24.081-27.893-35.246c-10.059-11.1-19.733-22.159-26.124-33.692l-0.08-0.128l-0.089-0.152 c-13.005-21.959-20.462-47.514-20.47-74.928c0.008-40.803,16.506-77.626,43.238-104.374C178.374,41.1,215.197,24.61,256,24.602 C296.804,24.61,333.627,41.1,360.375,67.84c26.732,26.748,43.23,63.571,43.238,104.374 C403.605,199.628,396.149,225.183,383.143,247.142z"></path> </g> </svg>
        <button class="btn" v-if="state.leds" v-on:click="turn('off')">LED Off</button>
        <button class="btn" v-else v-on:click="turn('on')">LED On</button>
    </div>
    <div class="values">
        <ul>
            <li><span class="midashi">Tempture: </span><span>[[ state.tempture ]]</span><span class="scale"> C</span></li>
            <li><span class="midashi">Pressure: </span><span>[[ state.pressure ]]</span><span class="scale midashi"> hPa</span></li>
	    <li><span class="midashi">Compass: </span><span>[[ state.compass ]]</span><span class="scale"> C</span></li>
            <li><span class="midashi">Gyro : </span><span>[[ state.gyro ]]</span></li>
        </ul>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/superagent/3.8.3/superagent.min.js"></script>
<script type="text/javascript">
const request = window.superagent

var app = new Vue({
  el: '#app',
  delimiters: ["[[", "]]"],
  data: {
    state: {
        tempture: 30,
        pressure: 1024,
        compass: 0,
        gyro: 0,
        leds: false
    }
  },
  beforeMount () {
    this.interval = setInterval(this.refresh, 3000)
  },
  methods: {
    refresh: () => {
        request.get('/environ').end((e, r) => {
            if(r.ok && !r.body.error) {
                app.state.tempture =  Math.round(r.body.results.tempture)
                app.state.pressure =  Math.round(r.body.results.pressure)
                app.state.compass =  Math.round(r.body.results.compass)
                app.state.gyro = r.body.results.gyro
                app.state.leds = r.body.results.leds
            }
        })
    },
    turn: (s) => {
        request.get('/led/'+s).end((e, r) => {
            if(r.ok) {
                app.state.leds = r.body.result
            }
        })
    }
  }
})

app.refresh()

</script>
</body>
</html>
